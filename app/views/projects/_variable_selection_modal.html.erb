<div class="modal fade variable-selection" id="variable-subsetting-modal" data-bind="with: $root.ui.variableSelector" role="dialog" tabindex="-1" aria-labelledby="variable-selection-modal-title">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title" id="variable-selection-modal-title"><i class="fa fa-tags"></i> Variable Selection</h1>
      </div>

      <div class="modal-body">
        <div class="message-container" data-bind="visible: _pending()">
          <p>Loading...</p>
        </div>

        <div class="message-container" data-bind="visible: !_pending() && variables().length == 0">
          <p>This collection doesn't have any associated variables.</p>
        </div>

        <div class="keyword-list" data-bind="visible: !selectedKeyword()">
          <ul id="associated-variables" data-bind="foreach: keywordMappings">
            <li>
              <a href="#" data-bind="click: $parent.selectKeyword, text: $data.keyword"></a>
              <!-- ko if: $data.selected > 0 -->
              <span class="pill" data-bind="text: $data.selected + ' selected'"></span>
              <!-- /ko -->
            </li>
          </ul>
        </div>

        <div class="variable-list" data-bind="with: selectedKeyword(), visible: selectedKeyword()">
          <span class="selected-keyword">
            <a href="#" data-bind="click: $parent.clearKeyword">All Leafnodes</a>
            <i class="child-spacer fa fa-chevron-circle-right"></i>
            <strong data-bind="text: $data.keyword"></strong>
          </span>

          <div>
            <label>
              <input type="checkbox" class="select-all" data-bind="checked: $parent.hasAllKeywordsSelected()">
              Select All Variables
            </label>
          </div>

          <div data-bind="foreach: $data.variables">
            <div class="collection-variable-list">
              <label>
                <input type="checkbox" data-bind="checked: $parents[1].selectedProjectCollection().hasSelectedVariable($data), attr: {value: $data.meta()['concept-id']}">
                <b data-bind="text: $data.umm().Name"></b>
              </label>
              <p class="description" data-bind="text: $data.umm().LongName"></p>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <div class="action-container">
          <button class="button secondary" data-bind="visible: !selectedKeyword()" data-dismiss="modal">Done</button>
          <button class="button secondary" data-bind="visible: selectedKeyword(), click: clearKeyword">Back</button>
          <button class="save" data-bind="visible: selectedKeyword()">Save</button>
        </div>
      </div>
    </div>
  </div>
</div>
